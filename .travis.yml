language: node_js
node_js:
  - "7"
cache:
  directories:
    - node_modules
install:
  - npm install
before_script:
  - git config --global user.name "tianzx"
  - git config --global user.email "tianzx@aliyun.com"
script:
  # 生成静态文件
  - npm run build
after_script:
  # 将生成的静态文件，初始化为 git 仓库
  - cd public
  - git init
  - git config user.name "tianzx"
  - git config user.email "tianzx@aliyun.com"
  - git add --all
  - git commit -m "push from the travis server"
  # 推送到 blog-html 分支
  - git push --force  "https://${GH_Token}@${GH_REF}" master:blog-html
env:
  global:
    - GH_REF: github.com/tianzx/blog.git